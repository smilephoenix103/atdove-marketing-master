var tb_position;window.wp=window.wp||{},function(l){var c,i;(c=wp.themes=wp.themes||{}).data=_wpThemeSettings,i=c.data.l10n,c.isInstall=c.data.settings.isInstall,_.extend(c,{model:{},view:{},routes:{},router:{},template:wp.template}),c.Model=Backbone.Model.extend({initialize:function(){var e;-1!==_.indexOf(c.data.installedThemes,this.get("slug"))&&this.set({installed:!0}),this.set({id:this.get("id")}),this.has("sections")&&(e=this.get("sections").description,this.set({description:e})),this.has("plan")&&this.set({plan_name:t(this.get("plan"))})}}),c.view.Appearance=wp.Backbone.View.extend({el:".wrap .theme-browser",events:{"click .filter-links li > a":"onSort"},window:l(window),page:0,activeClass:"current",initialize:function(e){_.bindAll(this,"scroller"),this.SearchView=e.SearchView?e.SearchView:c.view.Search,this.window.bind("scroll",_.throttle(this.scroller,300))},render:function(){this.view=new c.view.Themes({collection:this.collection,parent:this}),this.search(),this.view.render(),this.$el.append(this.view.el).addClass("rendered"),this.$el.append('<br class="clear"/>')},browse:function(t){var e;if(this.collection.length<=0&&this.collection.query({browse:t}),"featured"==t||"all"==t)this.collection.query({browse:t});else if(e=this.collection.filter(function(e){if(_.invert(e.attributes.tags).hasOwnProperty(t))return!0})){this.collection.reset(e);var i=this.collection.length}this.collection.trigger("update"),this.collection.trigger("query:success",i)},onSort:function(e){var t=l(e.target),i=t.data("sort");e.preventDefault(),l("body").removeClass("filters-applied show-filters"),t.hasClass(this.activeClass)||(this.collection.reset(c.data.themes,{silent:!0}),this.sort(i),c.router.navigate(c.router.baseUrl(c.router.browsePath+i)))},sort:function(e){this.clearSearch(),l(".filter-links li > a, .theme-filter").removeClass(this.activeClass),l('[data-sort="'+e+'"]').addClass(this.activeClass),"favorites"===e?l("body").addClass("show-favorites-form"):l("body").removeClass("show-favorites-form"),this.browse(e)},clearSearch:function(){l("#wp-filter-search-input").val("")},searchContainer:l(".search-form"),search:function(){var e;1!==c.data.themes.length&&((e=new this.SearchView({collection:this.collection,parent:this})).render(),this.searchContainer.append(l.parseHTML('<label class="screen-reader-text" for="wp-filter-search-input">'+i.search+"</label>")).append(e.el))},scroller:function(){var e,t,i=this;e=this.window.scrollTop()+i.window.height(),t=i.$el.offset().top+i.$el.outerHeight(!1)-i.window.height(),(t=Math.round(.9*t))<e&&this.trigger("theme:scroll")}}),c.Collection=Backbone.Collection.extend({model:c.Model,terms:"",doSearch:function(e){this.terms!==e&&(this.terms=e,0<this.terms.length&&this.search(this.terms),""===this.terms&&(this.reset(c.data.themes),l("body").removeClass("no-results")),this.trigger("update"))},search:function(t){var i,e,s,r,n,a;this.reset(c.data.themes,{silent:!0}),t=(t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")).replace(/ /g,")(?=.*"),i=new RegExp("^(?=.*"+t+").+","i"),0===(e=this.filter(function(e){return r=e.get("name").replace(/(<([^>]+)>)/gi,""),n=e.get("description").replace(/(<([^>]+)>)/gi,""),a=e.get("author").replace(/(<([^>]+)>)/gi,""),s=_.union(r,e.get("id"),n,a,e.get("tags")),i.test(e.get("author"))&&2<t.length&&e.set("displayAuthor",!0),i.test(s)})).length?this.trigger("query:empty"):l("body").removeClass("no-results"),this.reset(e)},paginate:function(e){var t=this;return e=e||0,t=_(t.rest(20*e)),t=_(t.first(20))},count:!1,query:function(t){var e,i,s,r=this.queries,n=this;if(this.currentQuery.request=t,e=_.find(r,function(e){return _.isEqual(e.request,t)}),(i=_.has(t,"page"))||(this.currentQuery.page=1),e||i){if(i)return this.apiCall(t,i).then(function(e){n.add(e.themes),n.trigger("query:success"),n.loadingThemes=!1}).fail(function(){n.trigger("query:fail")});0===e.themes.length?n.trigger("query:empty"):l("body").removeClass("no-results"),_.isNumber(e.total)&&(this.count=e.total),this.reset(e.themes),e.total||(this.count=this.length),this.trigger("update"),this.trigger("query:success",this.count)}else{if(c.data.themes){data=c.data.themes,n.add(data),void 0!==t.id&&(data=n.get(t.id),n.set(data));var a=_.sortBy(n.models,function(e){return e.attributes.modified});n.reset(a.reverse()),s=data.length,r.push({themes:data,request:t,total:s})}n.trigger("update"),n.trigger("query:success",s),data.themes&&0===data.themes.length&&n.trigger("query:empty")}},queries:[],currentQuery:{page:1,request:{}},loadingThemes:!1}),c.view.Theme=wp.Backbone.View.extend({className:"theme",state:"grid",html:c.template("theme"),events:{click:"preview",keydown:"preview",touchend:"preview",keyup:"addFocus",touchmove:"preventExpand"},touchDrag:!1,render:function(){var e=this.model.toJSON();this.$el.html(this.html(e)).attr({tabindex:0,"data-rating":e.rating,"data-plan":e.plan,"plan-name":e.plan_name}),e.custom_category&&0<e.custom_category.length&&this.$el.html(this.html(e)).attr({"data-categories":e.custom_category.join(" ")}),this.$el.addClass("igg-card"),this.$el.addClass(e.plan_name),this.model.get("displayAuthor")&&this.$el.addClass("display-author"),this.model.get("installed")&&this.$el.addClass("is-installed")},activeTheme:function(){this.model.get("active")&&this.$el.addClass("active")},addFocus:function(){var e=l(":focus").hasClass("theme")?l(":focus"):l(":focus").parents(".theme");l(".theme.focus").removeClass("focus"),e.addClass("focus")},expand:function(e){if("keydown"!==(e=e||window.event).type||13===e.which||32===e.which)return!0===this.touchDrag?this.touchDrag=!1:void(l(e.target).is(".theme-actions a")||(c.focusedTheme=this.$el,this.trigger("theme:expand",this.model.cid)))},preventExpand:function(){this.touchDrag=!0},preview:function(e){var t,i,s=this;if(e=e||window.event,!0===this.touchDrag)return this.touchDrag=!1;l(e.target).hasClass("button-primary")||"keydown"===e.type&&13!==e.which&&32!==e.which||"keydown"===e.type&&13!==e.which&&l(":focus").hasClass("button")||(e.preventDefault(),e=e||window.event,c.focusedTheme=this.$el,(i=new c.view.Preview({model:this.model})).render(),this.setNavButtonsState(),1===this.model.collection.length?i.$el.addClass("no-navigation"):i.$el.removeClass("no-navigation"),this.listenTo(i,"theme:next",function(){if(t=s.model,_.isUndefined(s.current)||(t=s.current),s.current=s.model.collection.at(s.model.collection.indexOf(t)+1),_.isUndefined(s.current))return s.options.parent.parent.trigger("theme:end"),s.current=t;i.model=s.current,i.render(),this.setNavButtonsState(),l(".next-theme").focus()}).listenTo(i,"theme:previous",function(){t=s.model,0!==s.model.collection.indexOf(s.current)&&(_.isUndefined(s.current)||(t=s.current),s.current=s.model.collection.at(s.model.collection.indexOf(t)-1),_.isUndefined(s.current)||(i.model=s.current,i.render(),this.setNavButtonsState(),l(".previous-theme").focus()))}),this.listenTo(i,"preview:close",function(){s.current=s.model}))},setNavButtonsState:function(){var e=l(".theme-install-overlay"),t=_.isUndefined(this.current)?this.model:this.current;0===this.model.collection.indexOf(t)&&e.find(".previous-theme").addClass("disabled"),_.isUndefined(this.model.collection.at(this.model.collection.indexOf(t)+1))&&e.find(".next-theme").addClass("disabled")}}),c.view.Details=wp.Backbone.View.extend({className:"theme-overlay",events:{click:"collapse","click .delete-theme":"deleteTheme","click .left":"previousTheme","click .right":"nextTheme"},html:c.template("theme-single"),render:function(){var e=this.model.toJSON();this.$el.html(this.html(e)),this.activeTheme(),this.navigation(),this.screenshotCheck(this.$el),this.containFocus(this.$el)},activeTheme:function(){this.$el.toggleClass("active",this.model.get("active"))},containFocus:function(t){var i;_.delay(function(){l(".theme-wrap a.button-primary:visible").focus()},500),t.on("keydown.wp-themes",function(e){9===e.which&&((i=l(e.target)).is("button.left")&&e.shiftKey?(t.find(".theme-actions a:last-child").focus(),e.preventDefault()):i.is(".theme-actions a:last-child")&&(t.find("button.left").focus(),e.preventDefault()))})},collapse:function(e){var t,i=this;e=e||window.event,1!==c.data.themes.length&&(l(e.target).is(".theme-backdrop")||l(e.target).is(".close")||27===e.keyCode)&&(l("body").addClass("closing-overlay"),this.$el.fadeOut(130,function(){l("body").removeClass("closing-overlay"),i.closeOverlay(),t=document.body.scrollTop,c.router.navigate(c.router.baseUrl("")),document.body.scrollTop=t,c.focusedTheme&&c.focusedTheme.focus()}))},navigation:function(){this.model.cid===this.model.collection.at(0).cid&&this.$el.find(".left").addClass("disabled"),this.model.cid===this.model.collection.at(this.model.collection.length-1).cid&&this.$el.find(".right").addClass("disabled")},closeOverlay:function(){l("body").removeClass("modal-open"),this.remove(),this.unbind(),this.trigger("theme:collapse")},deleteTheme:function(){return confirm(c.data.settings.confirmDelete)},nextTheme:function(){return this.trigger("theme:next",this.model.cid),!1},previousTheme:function(){return this.trigger("theme:previous",this.model.cid),!1},screenshotCheck:function(e){var t,i;t=e.find(".screenshot img"),(i=new Image).src=t.attr("src"),i.width&&i.width<=300&&e.addClass("small-screenshot")}}),c.view.Preview=c.view.Details.extend({className:"wp-full-overlay expanded",el:".ig-gallery-wrap .theme-install-overlay",events:{"click .close-full-overlay":"close","click .collapse-sidebar":"collapse","click .previous-theme":"previousTheme","click .next-theme":"nextTheme",keyup:"keyEvent"},html:c.template("theme-preview"),render:function(){var e=this,t=this.model.toJSON();this.$el.removeClass("iframe-ready").html(this.html(t)),c.router.navigate(c.router.baseUrl(c.router.themePath+this.model.get("id")),{replace:!0}),this.$el.fadeIn(200,function(){l("body").addClass("theme-installer-active full-overlay-active"),l(".close-full-overlay").focus()}),this.$el.find("iframe").one("load",function(){e.iframeLoaded()}),t.plan<=c.data.settings.ig_plan?this.$el.find(".theme-install").show():this.$el.find(".ig-get-pro").show()},iframeLoaded:function(){this.$el.addClass("iframe-ready")},close:function(){return this.$el.hide(200,function(){l("body").removeClass("theme-installer-active full-overlay-active"),c.focusedTheme&&c.focusedTheme.focus()}).removeClass("iframe-ready"),c.router.navigate(c.router.baseUrl("")),this.trigger("preview:close"),this.undelegateEvents(),this.unbind(),!1},collapse:function(e){var t=l(e.currentTarget);return"true"===t.attr("aria-expanded")?t.attr({"aria-expanded":"false","aria-label":i.expandSidebar}):t.attr({"aria-expanded":"true","aria-label":i.collapseSidebar}),this.$el.toggleClass("collapsed").toggleClass("expanded"),!1},keyEvent:function(e){27===e.keyCode&&(this.undelegateEvents(),this.close()),39===e.keyCode&&_.once(this.nextTheme()),37===e.keyCode&&this.previousTheme()}}),c.view.Themes=wp.Backbone.View.extend({className:"themes",$overlay:l("div.theme-overlay"),index:0,count:l(".wp-core-ui .theme-count"),liveThemeCount:0,initialize:function(e){var t=this;this.parent=e.parent,this.setView("grid"),t.currentTheme(),this.listenTo(t.collection,"update",function(){t.parent.page=0,t.currentTheme(),t.render(this)}),this.listenTo(t.collection,"query:success",function(e){_.isNumber(e)?(t.count.text(e),t.announceSearchResults(e)):(t.count.text(t.collection.length),t.announceSearchResults(t.collection.length))}),this.listenTo(t.collection,"query:empty",function(){l("body").addClass("no-results")}),this.listenTo(this.parent,"theme:scroll",function(){t.renderThemes(t.parent.page)}),this.listenTo(this.parent,"theme:close",function(){t.overlay&&t.overlay.closeOverlay()}),l("body").on("keyup",function(e){t.overlay&&(39===e.keyCode&&t.overlay.nextTheme(),37===e.keyCode&&t.overlay.previousTheme(),27===e.keyCode&&t.overlay.collapse(e))})},render:function(){this.$el.empty(),1===c.data.themes.length&&(this.singleTheme=new c.view.Details({model:this.collection.models[0]}),this.singleTheme.render(),this.$el.addClass("single-theme"),this.$el.append(this.singleTheme.el)),0<this.options.collection.size()&&this.renderThemes(this.parent.page),this.liveThemeCount=this.collection.count?this.collection.count:this.collection.length,this.count.text(this.liveThemeCount),this.announceSearchResults(this.liveThemeCount)},renderThemes:function(e){var t=this;t.instance=t.collection.paginate(e),0!==t.instance.size()?(!c.isInstall&&1<=e&&l(".add-new-theme").remove(),t.instance.each(function(e){t.theme=new c.view.Theme({model:e,parent:t}),t.theme.render(),t.$el.append(t.theme.el),t.listenTo(t.theme,"theme:expand",t.expand,t)}),!c.isInstall&&c.data.settings.canInstall&&this.$el.append('<div class="theme add-new-theme"><a href="'+c.data.settings.installURI+'"><div class="theme-screenshot"><span></span></div><h2 class="theme-name">'+i.addNew+"</h2></a></div>"),this.parent.page++):this.parent.trigger("theme:end")},currentTheme:function(){var e;(e=this.collection.findWhere({active:!0}))&&(this.collection.remove(e),this.collection.add(e,{at:0}))},setView:function(e){return e},expand:function(e){var t=this;this.model=t.collection.get(e),c.router.navigate(c.router.baseUrl(c.router.themePath+this.model.id)),this.setView("detail"),l("body").addClass("modal-open"),this.overlay=new c.view.Details({model:t.model}),this.overlay.render(),this.$overlay.html(this.overlay.el),this.listenTo(this.overlay,"theme:next",function(){t.next([t.model.cid])}).listenTo(this.overlay,"theme:previous",function(){t.previous([t.model.cid])})},next:function(e){var t,i;t=this.collection.get(e[0]),void 0!==(i=this.collection.at(this.collection.indexOf(t)+1))&&(this.overlay.closeOverlay(),this.theme.trigger("theme:expand",i.cid))},previous:function(e){var t,i;t=this.collection.get(e[0]),void 0!==(i=this.collection.at(this.collection.indexOf(t)-1))&&(this.overlay.closeOverlay(),this.theme.trigger("theme:expand",i.cid))},announceSearchResults:function(e){0===e?wp.a11y.speak(i.noThemesFound):wp.a11y.speak(i.themesFound.replace("%d",e))}}),c.view.Search=wp.Backbone.View.extend({tagName:"input",className:"wp-filter-search",id:"wp-filter-search-input",searching:!1,attributes:{placeholder:i.searchPlaceholder,type:"search","aria-describedby":"live-search-desc"},events:{input:"search",keyup:"search",blur:"pushState"},initialize:function(e){this.parent=e.parent,this.listenTo(this.parent,"theme:close",function(){this.searching=!1})},search:function(e){"keyup"===e.type&&27===e.which&&(e.target.value=""),this.doSearch(e)},doSearch:_.debounce(function(e){var t={};this.collection.doSearch(e.target.value),this.searching&&13!==e.which?t.replace=!0:this.searching=!0,e.target.value?c.router.navigate(c.router.baseUrl(c.router.searchPath+e.target.value),t):c.router.navigate(c.router.baseUrl(""))},500),pushState:function(e){var t=c.router.baseUrl("");e.target.value&&(t=c.router.baseUrl(c.router.searchPath+e.target.value)),this.searching=!1,c.router.navigate(t)}}),c.Router=Backbone.Router.extend({routes:{"demos/?item=:id":"preview","demos/?browse=:sort":"sort",demos:"sort","&search=:query":"search"},baseUrl:function(e){return"demos"+e},themePath:"?item=",browsePath:"?browse=",searchPath:"?search=",search:function(e){l(".wp-filter-search").val(e)},themes:function(){l(".wp-filter-search").val("")},navigate:function(){Backbone.history._hasPushState&&Backbone.Router.prototype.navigate.apply(this,arguments)}}),c.Run={init:function(){this.themes=new c.Collection(c.data.themes);var e=_.sortBy(this.themes.models,function(e){return e.attributes.modified});this.themes.reset(e.reverse()),this.view=new c.view.Appearance({collection:this.themes}),this.render()},render:function(){this.view.render(),this.routes(),Backbone.history.start({pushState:!0,hashChange:!1})},routes:function(){var t=this;request={},c.router=new c.Router,c.router.on("route:preview",function(e){request.id=e,t.view.collection.query(request),t.view.collection.once("update",function(){t.view.view.theme.preview()})}),c.router.on("route:themes",function(){t.themes.doSearch(""),t.view.trigger("theme:close")}),c.router.on("route:search",function(){l(".wp-filter-search").trigger("keyup")}),this.extraRoutes()},extraRoutes:function(){return!1}},c.view.InstallerSearch=c.view.Search.extend({events:{input:"search",keyup:"search"},search:function(e){("keyup"!==e.type||9!==e.which&&16!==e.which)&&(this.collection=this.options.parent.view.collection,"keyup"===e.type&&27===e.which&&(e.target.value=""),this.doSearch(e.target.value))},doSearch:_.debounce(function(e){var t,i,s,r,n,a;if(l(".filter-links li > a.current").removeClass("current"),l("body").removeClass("show-filters filters-applied show-favorites-form"),this.collection.filtered||this.collection.reset(c.data.themes,{silent:!0}),term=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),""!==term&&(term=term.replace(/ /g,")(?=.*"),t=new RegExp("^(?=.*"+term+").+","i"),i=this.collection.filter(function(e){return r=e.get("description"),n=(n=e.get("content").rendered.replace(/(<([^>]+)>)/gi,"")).replace(/\n/g,""),a=e.get("message_type"),s=a+n+r,t.test(s)}))){this.collection.reset(i);var o=this.collection.length}""===term&&this.collection.reset(c.data.themes,{silent:!0}),this.collection.trigger("update"),this.collection.trigger("query:success",o),c.router.navigate(c.router.baseUrl(c.router.searchPath+e),{replace:!0})},500)}),c.view.Installer=c.view.Appearance.extend({el:".wrap",events:{"click .filter-links li > a":"onSort","click .theme-filter":"onFilter","click .drawer-toggle":"moreFilters","click .filter-drawer .apply-filters":"applyFilters",'click .filter-group [type="checkbox"]':"addFilter","click .filter-drawer .clear-filters":"clearFilters","click .filtered-by":"backToFilters","click .favorites-form-submit":"saveUsername","keyup #wporg-username-input":"saveUsername","click .igg-sidebar .category-type":"filter","click .category.not_have_sub_cat":"filter"},render:function(){var e=this;this.search(),this.uploader(),this.collection=new c.Collection,this.listenTo(this,"theme:end",function(){e.collection.loadingThemes||(e.collection.loadingThemes=!0,e.collection.currentQuery.page++,_.extend(e.collection.currentQuery.request,{page:e.collection.currentQuery.page}),e.collection.query(e.collection.currentQuery.request))}),this.listenTo(this.collection,"query:success",function(){l("body").removeClass("loading-content"),l(".theme-browser").find("div.error").remove()}),this.listenTo(this.collection,"query:fail",function(){l("body").removeClass("loading-content"),l(".theme-browser").find("div.error").remove(),l(".theme-browser").find("div.themes").before('<div class="error"><p>'+i.error+"</p></div>")}),this.view&&this.view.remove(),this.view=new c.view.Themes({collection:this.collection,parent:this}),this.page=0,this.$el.find(".themes").remove(),this.view.render(),this.$el.find(".theme-browser").append(this.view.el).addClass("rendered")},browse:function(t){var e;if("featured"==t||"all"==t)this.collection.query({browse:t});else if(e=this.collection.filter(function(e){if(_.invert(e.attributes.tags).hasOwnProperty(t))return!0})){this.collection.reset(e);var i=this.collection.length}this.collection.trigger("update"),this.collection.trigger("query:success",i)},onSort:function(e){var t=l(e.target),i=t.data("sort");e.preventDefault(),l("body").removeClass("filters-applied show-filters"),t.hasClass(this.activeClass)||(this.collection.reset(c.data.themes,{silent:!0}),this.sort(i),c.router.navigate(c.router.baseUrl(c.router.browsePath+i)))},sort:function(e){this.clearSearch(),l(".filter-links li > a, .theme-filter").removeClass(this.activeClass),l('[data-sort="'+e+'"]').addClass(this.activeClass),"favorites"===e?l("body").addClass("show-favorites-form"):l("body").removeClass("show-favorites-form"),this.browse(e)},onFilter:function(e){var t,i=l(e.target),s=i.data("filter");i.hasClass(this.activeClass)||(l(".filter-links li > a, .theme-section").removeClass(this.activeClass),i.addClass(this.activeClass),s&&(t={tag:[s=_.union(s,this.filtersChecked())]},this.collection.query(t)))},addFilter:function(){this.filtersChecked()},applyFilters:function(e){var t,i=this.filtersChecked(),s={tag:i},r=l(".filtered-by .tags");e&&e.preventDefault(),l("body").addClass("filters-applied"),l(".filter-links li > a.current").removeClass("current"),r.empty(),_.each(i,function(e){t=l('label[for="filter-id-'+e+'"]').text(),r.append('<span class="tag">'+t+"</span>")}),this.collection.query(s)},filter:function(e){var t,i=l(e.currentTarget),s=i.attr("category"),r=i.attr(s),n=0;if(this.collection.reset(c.data.themes,{silent:!0}),"reset"!=s&&(t=this.collection.filter(function(e){var t=Number(r);if(-1<e.get("custom_category").indexOf(Number(t)))return n++,e})),0<n);void 0!==t&&(this.collection.reset(t),this.collection.filtered=!0,delete t),this.collection.trigger("update"),this.collection.trigger("query:success",n)},customFilter:function(e){var t,i=0;if(this.collection.reset(c.data.themes,{silent:!0}),t=this.collection.filter(function(e){var t=Number(51);if(-1<e.get("custom_category").indexOf(Number(t)))return i++,e}),0<i);void 0!==t&&(this.collection.reset(t),this.collection.filtered=!0,delete t),this.collection.trigger("update"),this.collection.trigger("query:success",i)},saveUsername:function(e){var t=l("#wporg-username-input").val(),i={browse:"favorites",user:t},s=this;if(e&&e.preventDefault(),"keyup"!==e.type||13===e.which)return wp.ajax.send("save-wporg-username",{data:{username:t},success:function(){s.collection.query(i)}})},filtersChecked:function(){var e=l(".filter-group").find(":checkbox"),t=[];return _.each(e.filter(":checked"),function(e){t.push(l(e).prop("value"))}),0===t.length?(l(".filter-drawer .apply-filters").find("span").text(""),l(".filter-drawer .clear-filters").hide(),l("body").removeClass("filters-applied"),!1):(l(".filter-drawer .apply-filters").find("span").text(t.length),l(".filter-drawer .clear-filters").css("display","inline-block"),t)},activeClass:"current",searchContainer:l(".search-form"),uploader:function(){l("a.upload").on("click",function(e){e.preventDefault(),l("body").addClass("show-upload-theme"),c.router.navigate(c.router.baseUrl("?upload"),{replace:!0})}),l("a.browse-themes").on("click",function(e){e.preventDefault(),l("body").removeClass("show-upload-theme"),c.router.navigate(c.router.baseUrl(""),{replace:!0})})},moreFilters:function(e){return e.preventDefault(),l("body").hasClass("filters-applied")?this.backToFilters():l("body").hasClass("show-filters")&&this.filtersChecked()?this.addFilter():(this.clearSearch(),c.router.navigate(c.router.baseUrl("")),void l("body").toggleClass("show-filters"))},clearFilters:function(e){var t=l(".filter-group").find(":checkbox"),i=this;e.preventDefault(),_.each(t.filter(":checked"),function(e){return l(e).prop("checked",!1),i.filtersChecked()})},backToFilters:function(e){e&&e.preventDefault(),l("body").removeClass("filters-applied")},clearSearch:function(){l("#wp-filter-search-input").val("")}}),c.InstallerRouter=Backbone.Router.extend({routes:{"edit.php?post_type=ig_campaign&page=icegram-gallery&item=:id":"preview","edit.php?post_type=ig_campaign&page=icegram-gallery&browse=:sort":"sort","edit.php?post_type=ig_campaign&page=icegram-gallery":"sort","post-new.php?post_type=ig_campaign":"sort","edit.php?post_type=ig_campaign&page=icegram-gallery&search=:query":"search"},baseUrl:function(e){return"edit.php?post_type=ig_campaign&page=icegram-gallery"+e},themePath:"&item=",browsePath:"&browse=",searchPath:"&search=",search:function(e){l(".wp-filter-search").val(e)},navigate:function(){Backbone.history._hasPushState&&Backbone.Router.prototype.navigate.apply(this,arguments)}}),c.RunInstaller={init:function(){this.view=new c.view.Installer({section:"featured",SearchView:c.view.InstallerSearch}),this.render()},render:function(){this.view.render(),this.routes(),Backbone.history.start({root:c.data.settings.adminUrl,pushState:!0,hashChange:!1})},routes:function(){var t=this,i={};c.router=new c.InstallerRouter,c.router.on("route:preview",function(e){i.id=e,t.view.collection.query(i),t.view.collection.once("update",function(){t.view.view.theme.preview()})}),c.router.on("route:sort",function(e){e=e||"featured",t.view.sort(e),t.view.trigger("theme:close")}),c.router.on("route:upload",function(){l("a.upload").trigger("click")}),c.router.on("route:search",function(){l(".wp-filter-search").focus().trigger("keyup")}),this.extraRoutes()},extraRoutes:function(){return!1}};var t=function(e){var t="";switch(e){case"0":t="free";break;case"1":t="plus";break;case"2":t="pro";break;case"3":t="max"}return t};l(document).ready(function(){c.isInstall?c.RunInstaller.init():c.Run.init(),l(".broken-themes .delete-theme").on("click",function(){return confirm(_wpThemeSettings.settings.confirmDelete)})})}(jQuery),jQuery(document).ready(function(n){tb_position=function(){var e=n("#TB_window"),t=n(window).width(),i=n(window).height(),s=1040<t?1040:t,r=0;n("#wpadminbar").length&&(r=parseInt(n("#wpadminbar").css("height"),10)),e.size()&&(e.width(s-50).height(i-45-r),n("#TB_iframeContent").width(s-50).height(i-75-r),e.css({"margin-left":"-"+parseInt((s-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:20+r+"px","margin-top":"0"}))},n(window).resize(function(){tb_position()})});